class KifuViewer{constructor(t,n){this.board=t,this.canvas=document.createElement("canvas").getContext("2d"),this.canvas.font="22px YuMincho, Hiragino Mincho ProN, MS Mincho, serif",this.options=n||{},this.options.buttons||(this.options.buttons="default"),this.options.keybinds||(this.options.keybinds=this.board.parentNode),this.options.comment||(this.options.comment=null),this.options.start||(this.options.start=0),this.options.reverse||(this.options.reverse=!1),this.options.onMove||(this.options.onMove=()=>{})}defaultButtons(){return`
<div class='kifu-viewer-buttons mb-2' style='text-align:center;'>
<button class='kifu-viewer-first material-icons btn btn-lg btn-outline-secondary'>first_page</button>
<button class='kifu-viewer-prev material-icons btn btn-lg btn-outline-secondary'>chevron_left</button>
<button class='kifu-viewer-next material-icons btn btn-lg btn-outline-secondary'>chevron_right</button>
<button class='kifu-viewer-last material-icons btn btn-lg btn-outline-secondary'>last_page</button>
<button class='kifu-viewer-reverse material-icons btn btn-lg btn-outline-secondary'>autorenew</button>
</div>`}loadKeybinds(){this.options.keybinds.addEventListener("keydown",t=>{switch(t.key){case"ArrowUp":this.first();break;case"ArrowDown":this.last();break;case"ArrowLeft":this.prev();break;case"ArrowRight":this.next();break}})}loadButtons(){this.options.buttons!="none"&&(this.options.buttons=="default"&&(this.board.insertAdjacentHTML("afterend",this.defaultButtons()),this.options.buttons=this.board.nextElementSibling),[...this.options.buttons.getElementsByClassName("kifu-viewer-first")].forEach(t=>{t.addEventListener("click",()=>{this.first()})}),[...this.options.buttons.getElementsByClassName("kifu-viewer-prev")].forEach(t=>{t.addEventListener("click",()=>{this.prev()})}),[...this.options.buttons.getElementsByClassName("kifu-viewer-next")].forEach(t=>{t.addEventListener("click",()=>{this.next()})}),[...this.options.buttons.getElementsByClassName("kifu-viewer-last")].forEach(t=>{t.addEventListener("click",()=>{this.last()})}),[...this.options.buttons.getElementsByClassName("kifu-viewer-reverse")].forEach(t=>{t.addEventListener("click",()=>{this.reverse()})}))}get(t,n,e){const s=new XMLHttpRequest;s.open("GET",t),s.timeout=6e4,s.onloadend=()=>{e(s.responseText)},s.overrideMimeType("text/plain; charset="+n),s.send()}load(t,n,e=()=>{}){n=n||"UTF-8",this.get(t,n,s=>{this.data=KifuViewer.KIF解析(s),this.data.手数=KifuViewer.手数正規化(this.options.start,this.data.総手数),this.data.全局面=KifuViewer.全局面構築(this.data.全指し手,this.data.初期局面),this.局面描画(this.data.手数,this.data.手数),e(this.data)}),this.loadButtons(),this.loadKeybinds()}loadString(t,n=()=>{}){this.data=KifuViewer.KIF解析(t),this.data.手数=KifuViewer.手数正規化(this.options.start,this.data.総手数),this.data.全局面=KifuViewer.全局面構築(this.data.全指し手,this.data.初期局面),this.局面描画(this.data.手数,this.data.手数),this.loadButtons(),this.loadKeybinds(),n(this.data)}static 手数正規化(t,n){return!t||!n?0:(t<0&&(t=n+t+1),t>n?n:t)}static 全局面構築(t,n){const e=[];for(let s=0;s<t.length;s++){e[s]=[n];for(let l=1;l<t[s].length;l++)e[s].push(KifuViewer.全局面構築.各局面(t[s][l],e[s][l-1]))}return e}static KIF解析(t){const n={},e={局面図:[],解析:[]};t=t.split(/\r?\n/);for(let s=0;s<t.length;s++)if(t[s]=t[s].trim(),t[s].indexOf("#")!==0){if(t[s].indexOf("|")===0)e.局面図.push(t[s]);else if(t[s].indexOf("：")>-1){const l=t[s].split("：");e[l[0]]=l[1]}else if(t[s].indexOf("**Engines")===0)e.解析済み=!0;else if(t[s]==="後手番"||t[s]==="上手番")e.開始手番="後手";else if(t[s]==="先手番"||t[s]==="下手番")e.開始手番="先手";else if(t[s].match(/手数＝\d/))e.最終手=t[s];else if(t[s].match(/^[1\*]/)){e.指し手=t.slice(s);break}}return n.先手名=e.先手||e.下手||"",n.後手名=e.後手||e.上手||"",n.開始手番=KifuViewer.KIF解析.開始手番(e.開始手番,e.手合割),n.最終手=KifuViewer.KIF解析.最終手(e.最終手),n.手合割=KifuViewer.KIF解析.手合割(e.手合割),n.評価値=e.解析済み?KifuViewer.KIF解析.評価値(e.指し手):[],n.読み筋=e.解析済み?KifuViewer.KIF解析.読み筋(e.指し手):["-"],n.初期局面={駒:KifuViewer.KIF解析.局面図(e.局面図,n.手合割),先手の持駒:KifuViewer.KIF解析.持駒(e.先手の持駒||e.下手の持駒),後手の持駒:KifuViewer.KIF解析.持駒(e.後手の持駒||e.上手の持駒)},n.全指し手=KifuViewer.KIF解析.指し手(e.指し手,n.開始手番),n.総手数=n.全指し手[0].length-1,n.変化=0,n}static オブジェクトコピー(t){const n=Array.isArray(t)?[]:{};for(const e in t)n[e]=t[e]instanceof Object?KifuViewer.オブジェクトコピー(t[e]):t[e];return n}static 局面停止状態(t){return t.駒=="終"}static svg(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}static svgText(t,n,e,s,l){const i=KifuViewer.svg("text");return i.setAttribute("x",t),i.setAttribute("y",n),i.setAttribute("font-size",e),i.setAttribute("font-family","YuMincho, Hiragino Mincho ProN, MS Mincho, serif"),i.setAttribute("text-anchor",l),i.textContent=s,i}static svgLine(t,n,e,s){const l=KifuViewer.svg("line");return l.setAttribute("x1",t),l.setAttribute("x2",e),l.setAttribute("y1",n),l.setAttribute("y2",s),l.setAttribute("stroke","#000"),l.setAttribute("stroke-width",1),l}static svgRect(t,n,e,s){const l=KifuViewer.svg("rect");return l.setAttribute("x",t),l.setAttribute("y",n),l.setAttribute("width",e),l.setAttribute("height",s),l}指し手表示(t,n){let e;if(n.手数==0)e="開始局面";else{const s=n.手番==="▲"?"☗":"☖";e=n.手数+"手目  "+s+n.手}t?this.board.childNodes[1].textContent=e:this.board.appendChild(KifuViewer.svgText(15,530,17,e,"center"))}持駒計算(t){let n="";for(const e in t)t[e]!=0&&(n!=""&&(n+=" "),n+=e+t[e]);return n==""?"なし":n}持駒表示(t,n,e){const s=this.持駒計算(n.先手の持駒),l=this.持駒計算(n.後手の持駒),i=e?s:l,u=e?l:s;if(t)this.board.childNodes[2].firstChild.textContent=i,this.board.childNodes[3].firstChild.textContent=u;else{const r=KifuViewer.svgText(0,0,21,i,"left");r.setAttribute("transform","translate(15, 53)");const a=KifuViewer.svgText(0,0,21,u,"left");a.setAttribute("transform","translate(15, 500)"),this.board.appendChild(r),this.board.appendChild(a)}}局面描画(t,n){this.data.手数=n;const e=this.data.全局面[this.data.変化][n],s=this.data.全指し手[this.data.変化][n],l=this.data.全指し手[this.data.変化][t],i=this.options.reverse;this.board.childNodes.length>0?(this.指し手表示(!0,s),this.持駒表示(!0,e,i),this.駒配置(!0,e,i,s,l),this.評価値表示(!0,this.data.評価値[n],s)):(this.将棋盤描画(),this.指し手表示(!1,s),this.持駒表示(!1,e,i),this.指し手強調(!1,0,0),this.駒配置(!1,e,i,s,l),this.符号表示(!1,i),this.上下名称表示(!1,i),this.評価値表示(!1,this.data.評価値[n],s),this.showAttribution()),this.コメント表示(s.コメント)}コメント表示(t){this.options.comment&&(this.options.comment.innerHTML=t)}指し手初期化(){this.board.childNodes[4].setAttribute("fill","none")}指し手強調(t,n,e){if(t)this.board.childNodes[4].setAttribute("transform",`translate(${n}, ${e})`);else{const s=KifuViewer.svgRect(n,e,40,40);s.setAttribute("fill","none"),this.board.appendChild(s)}}駒配置(t,n,e,s,l){let i;if(t?i=this.board.childNodes[5]:(i=KifuViewer.svg("g"),this.board.appendChild(i)),l&&Math.abs(s.手数-l.手数)==1){if(s.手数<l.手数){if(KifuViewer.局面停止状態(l))return;l.前X!=0&&this.駒描画(t,i,n.駒[l.前Y][l.前X],l.前X,l.前Y,!1,e),this.駒描画(t,i,n.駒[l.後Y][l.後X],l.後X,l.後Y,!1,e)}else{if(KifuViewer.局面停止状態(s))return;l.手数>=1&&this.駒描画(t,i,n.駒[l.後Y][l.後X],l.後X,l.後Y,!1,e)}s.手数==0?this.指し手初期化():(s.前X!=0&&this.駒描画(t,i,n.駒[s.前Y][s.前X],s.前X,s.前Y,!1,e),this.駒描画(t,i,n.駒[s.後Y][s.後X],s.後X,s.後Y,!0,e))}else if(this.data.最終手){const u=this.data.最終手[0],r=this.data.最終手[1];for(const a in n.駒)for(const c in n.駒[a]){let h=!1;c==u&&a==r&&(h=!0),this.駒描画(t,i,n.駒[a][c],c,a,h,e)}}else for(const u in n.駒)for(const r in n.駒[u]){let a=!1;r==s.後X&&u==s.後Y&&(a=!0),this.駒描画(t,i,n.駒[u][r],r,u,a,e)}}駒描画(t,n,e,s,l,i,u){s=10-s,e||(e=""),u&&(s=10-s,l=10-l,e=e.match("_")?e.replace("_",""):e+"_");let r=e;e.match("_")&&(r=e.replace("_",""));const a=40*s-40+32,c=40*l-40+94;i&&(this.board.childNodes[4].setAttribute("fill","#111111"),this.指し手強調(!0,a-20,c-16));let h;if(t){const d=u?80-9*l+s:9*l-s;h=n.childNodes[d],h.textContent=r}else h=KifuViewer.svgText(0,0,31,r,"middle"),h.setAttribute("dy",16),n.appendChild(h);e.match("_")?h.setAttribute("transform",`translate(${a}, ${c+8}) scale(-1, -1)`):h.setAttribute("transform",`translate(${a}, ${c})`),i?h.setAttribute("fill","#fff"):h.setAttribute("fill","#000")}盤外表示(){const t=KifuViewer.svgRect(0,58,395,390);return t.setAttribute("touch-action","manipulation"),t.setAttribute("fill","#FFE084"),t}盤枠表示(){const t=KifuViewer.svgRect(12,77,360,360);return t.setAttribute("fill","#FFE084"),t.setAttribute("stroke","#000"),t.setAttribute("stroke-width",2),t.setAttribute("id","ban"),t}showAttribution(){const t=KifuViewer.svg("a");t.setAttribute("href","https://marmooo.github.io/kifu-viewer/");const n=KifuViewer.svgText(300,500,17,"KifuViewer","left");n.setAttribute("text-decoration","underline"),t.appendChild(n),this.board.appendChild(t)}名称表示サイズ(t){const n=this.canvas.measureText(t).width;return n<395?22:n/t.length}上下名称表示(t,n){const e=this.data.先手名==""?"先手":this.data.先手名,s=this.data.後手名==""?"後手":this.data.後手名,l=n?"☗"+e:"☖"+s,i=n?"☖"+s:"☗"+e,u=this.名称表示サイズ(l),r=this.名称表示サイズ(i);if(t){const a=this.board.childNodes[7].childNodes;a[0].textContent=l,a[1].textContent=i,a[0].setAttribute("font-size",u),a[1].setAttribute("font-size",r)}else{const a=KifuViewer.svg("g");this.board.appendChild(a),a.appendChild(KifuViewer.svgText(10,23,u,l,"left")),a.appendChild(KifuViewer.svgText(10,470,r,i,"left"))}}評価値表示(t,n,e){let s="評価値  -";if(e!==void 0&&e!=="投了"&&n!==void 0){let l="";if(n.match("詰"))l="勝勢";else{const u=n.replace("-","");0<=u&&u<=300?l="互角":301<=u&&u<=800?l="有利":801<=u&&u<=1500?l="優勢":1501<=u?l="勝勢":l=""}let i;n.match("-")?i="☖後手":i="☗先手",l=="互角"&&(i=""),s="評価値  "+i+l+"("+n+")"}t?this.board.childNodes[8].textContent=s:this.board.appendChild(KifuViewer.svgText(215,530,17,s,"left"))}枡目表示(){const t=document.createDocumentFragment();for(let n=1;n<=8;n++)t.appendChild(KifuViewer.svgLine(12+40*n,77.5,12+40*n,360+77.5)),t.appendChild(KifuViewer.svgLine(12,77.5+40*n,370,77.5+40*n));return t}符号表示(t,n){let e=["１","２","３","４","５","６","７","８","９"],s=["一","二","三","四","五","六","七","八","九"];if(n&&(e=["９","８","７","６","５","４","３","２","１"],s=["九","八","七","六","五","四","三","二","一"]),t){const l=this.board.childNodes[6].childNodes;for(let i=0;i<=8;i+=1)l[i*2].textContent=e[i],l[i*2+1].textContent=s[i]}else{const l=KifuViewer.svg("g");this.board.appendChild(l);for(let i=0;i<=8;i++)l.appendChild(KifuViewer.svgText(355-40*i,73,14,e[i],"middle")),l.appendChild(KifuViewer.svgText(386,100+40*i,14,s[i],"middle"))}}将棋盤描画(){const t=KifuViewer.svg("g");this.board.appendChild(t),t.appendChild(this.盤外表示()),t.appendChild(this.盤枠表示()),t.appendChild(this.枡目表示())}first(){this.指し手初期化(),this.局面描画(this.data.手数,0),this.options.onMove(this.data)}prev(){this.data.手数>0&&(this.局面描画(this.data.手数,this.data.手数-1),this.options.onMove(this.data))}next(){const t=this.data.全指し手[this.data.変化].length-1;this.data.手数<t&&(this.局面描画(this.data.手数,this.data.手数+1),this.options.onMove(this.data))}last(){const t=this.data.全指し手[this.data.変化].length-1;this.局面描画(this.data.手数,t),this.options.onMove(this.data)}reverse(){this.options.reverse=!this.options.reverse,this.符号表示(!0,this.options.reverse),this.上下名称表示(!0,this.options.reverse),this.局面描画(this.data.手数,this.data.手数)}}KifuViewer.全局面構築.各局面=function(o,t){const n=KifuViewer.オブジェクトコピー(t);if(KifuViewer.局面停止状態(o))return n;const e=o.手番==="▲"?"先手":"後手",s={歩:"と",香:"杏",桂:"圭",銀:"全",角:"馬",飛:"龍"},l={と:"歩",杏:"香",圭:"桂",全:"銀",馬:"角",龍:"飛"};let i=o.駒;if(o.前X!==0){if(n.駒[o.前Y][o.前X]=null,o.成り&&(i=i in s?s[i]:i),n.駒[o.後Y][o.後X]){let u=n.駒[o.後Y][o.後X].replace("_","");u=u in l?l[u]:u,n[e+"の持駒"][u]++}}else n[e+"の持駒"][i]--;return e==="後手"&&(i+="_"),n.駒[o.後Y][o.後X]=i,n},KifuViewer.KIF解析.開始手番=function(o,t){return o||(t&&t!=="平手"?"後手":"先手")},KifuViewer.KIF解析.最終手=function(o){if(!o)return;const t=o.match(/([１２３４５６７８９])(.)/);if(t){const n={"１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9"},e={一:"1",二:"2",三:"3",四:"4",五:"5",六:"6",七:"7",八:"8",九:"9"};return n[t[1]]+e[t[2]]}else return},KifuViewer.KIF解析.手合割=function(o){return["香落ち","右香落ち","角落ち","飛車落ち","飛香落ち","二枚落ち","三枚落ち","四枚落ち","五枚落ち","左五枚落ち","六枚落ち","八枚落ち","十枚落ち","その他"].indexOf(o)>=0?o:null},KifuViewer.KIF解析.局面図=function(o,t){if(o.length!==9)return t?KifuViewer.KIF解析.局面図.手合割(t):KifuViewer.KIF解析.局面図.平手();const n=KifuViewer.KIF解析.局面図.駒無し();let e=!0,s=10;const l={王:"玉",竜:"龍"};for(let i=0;i<9;i++){s=10;const u=o[i];for(let r=1;r<u.length;r++){if(u[r]===" "){e=!0,s-=1;continue}else if(u[r]==="v"){e=!1,s-=1;continue}else{if(u[r]==="|")break;if(u[r]==="・")continue}let a=u[r];a=a in l?l[a]:a,n[i+1][s]=e?a:a+"_"}}return n},KifuViewer.KIF解析.局面図.平手=function(){return{"1":{"9":"香_","8":"桂_","7":"銀_","6":"金_","5":"玉_","4":"金_","3":"銀_","2":"桂_","1":"香_"},"2":{"9":null,"8":"飛_","7":null,"6":null,"5":null,"4":null,"3":null,"2":"角_","1":null},"3":{"9":"歩_","8":"歩_","7":"歩_","6":"歩_","5":"歩_","4":"歩_","3":"歩_","2":"歩_","1":"歩_"},"4":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"5":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"6":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"7":{"9":"歩","8":"歩","7":"歩","6":"歩","5":"歩","4":"歩","3":"歩","2":"歩","1":"歩"},"8":{"9":null,"8":"角","7":null,"6":null,"5":null,"4":null,"3":null,"2":"飛","1":null},"9":{"9":"香","8":"桂","7":"銀","6":"金","5":"玉","4":"金","3":"銀","2":"桂","1":"香"}}},KifuViewer.KIF解析.局面図.駒無し=function(){return{"1":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"2":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"3":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"4":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"5":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"6":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"7":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"8":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null},"9":{"9":null,"8":null,"7":null,"6":null,"5":null,"4":null,"3":null,"2":null,"1":null}}},KifuViewer.KIF解析.局面図.手合割=function(o){const t=KifuViewer.KIF解析.局面図.平手();switch(o){case"香落ち":return t[1][1]=null,t;case"右香落ち":return t[1][9]=null,t;case"角落ち":return t[2][2]=null,t;case"飛車落ち":return t[2][8]=null,t;case"飛車香落ち":return t[1][1]=null,t[2][8]=null,t;case"二枚落ち":return t[2][2]=null,t[2][8]=null,t;case"三枚落ち":return t[1][1]=null,t[2][2]=null,t[2][8]=null,t;case"四枚落ち":return t[1][1]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;case"五枚落ち":return t[1][1]=null,t[1][2]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;case"左五枚落ち":return t[1][1]=null,t[1][8]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;case"六枚落ち":return t[1][1]=null,t[1][2]=null,t[1][8]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;case"八枚落ち":return t[1][1]=null,t[1][2]=null,t[1][3]=null,t[1][7]=null,t[1][8]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;case"十枚落ち":return t[1][1]=null,t[1][2]=null,t[1][3]=null,t[1][4]=null,t[1][6]=null,t[1][7]=null,t[1][8]=null,t[1][9]=null,t[2][2]=null,t[2][8]=null,t;default:return t}},KifuViewer.KIF解析.持駒=function(o){const t={歩:0,香:0,桂:0,銀:0,金:0,飛:0,角:0};if(o===void 0||o.match("なし"))return t;const n={一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9,十:10,十一:11,十二:12,十三:13,十四:14,十五:15,十六:16,十七:17,十八:18},e=o.split(/\s/);for(let s=0;s<e.length;s++){const l=e[s][0],i=e[s][1];l in t&&(t[l]=i?n[i]:1)}return t},KifuViewer.KIF解析.指し手=function(o,t){const n=[[{手数:0,コメント:""}]];let e=0,s=0;if(n.変化手数=[],!o)return n;for(let l=0;l<o.length;l++)o[l]=o[l].trim(),o[l].indexOf("*")===0&&n[s][e]?n[s][e].コメント+=o[l].replace(/^\*/,"")+`
`:o[l].match(/^\d/)?(e++,KifuViewer.KIF解析.指し手.現在の手(n[s],o[l],e,t)):o[l].indexOf("変化：")===0&&(e=Number(o[l].match(/変化：(\d+)/)[1]),n.push(n[0].slice(0,e)),n.変化手数.push(e),e--,s++);return n},KifuViewer.KIF解析.指し手.手番解析=function(o,t){return o=="先手"?t%2==1?"▲":"△":t%2==1?"△":"▲"},KifuViewer.KIF解析.指し手.現在の手=function(o,t,n,e){const s={"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9},l={一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9},i=["中断","投了","持将棋","千日手","詰み","切れ負け","反則勝ち","反則負け","入玉勝ち"],u=KifuViewer.KIF解析.指し手.手番解析(e,n),r=t.split(/ +/)[1]||"",a=r.match(/([１-９同])([一二三四五六七八九\u3000])([^\(]+)(\((\d)(\d)\))?/);if(a)o.push({手数:n,手番:u,手:a[0],駒:a[3].replace(/[打成]$/,"").replace("成銀","全").replace("成桂","圭").replace("成香","杏").replace("王","玉").replace("竜","龍"),前X:Number(a[5]||0),前Y:Number(a[6]||0),後X:a[1]==="同"?o[n-1].後X:s[a[1]],後Y:a[1]==="同"?o[n-1].後Y:l[a[2]],成り:/成$/.test(a[3]),コメント:""});else if(0<=i.indexOf(r)){const c=o[o.length-1];o.push({手数:n,手番:u,手:r,駒:"終",前X:0,前Y:0,後X:c.後X,後Y:c.後Y,成り:!1,コメント:""}),o.勝敗=KifuViewer.KIF解析.指し手.勝敗(r,u)}},KifuViewer.KIF解析.指し手.勝敗=function(o,t){const n={勝者:"",敗者:"",理由:o,表記:""};switch(o){case"投了":case"詰み":case"切れ負け":case"反則負け":n.勝者=t==="▲"?"△":"▲",n.敗者=t==="▲"?"▲":"△",n.表記=n.敗者+o+"で"+n.勝者+"の勝ち";break;case"反則勝ち":case"入玉勝ち":n.勝者=t==="▲"?"▲":"△",n.敗者=t==="▲"?"△":"▲",n.表記=n.勝者+o;break;case"時将棋":case"千日手":n.勝者=n.敗者="引き分け",n.表記=o+"で引き分け";break;case"中断":n.表記=o}return n},KifuViewer.KIF解析.評価値=function(o){const t=[];for(let n=0;n<o.length;n++)o[n].indexOf("**解析 0 ")===0&&t.push(o[n].match(/評価値 (\S+)/)[1].replace(/↓|↑/,""));return t},KifuViewer.KIF解析.読み筋=function(o){const t=["-"];for(let n=0;n<o.length;n++)o[n].indexOf("**解析 0 ")===0;return t};
